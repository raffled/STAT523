Stat 523
--------

### Assignment 1: Data Structures and Subsetting

#### Explain your code where appropriate.
#### Doug Raffle (dcraffle@mix.wvu.edu)

1. Create vectors of each of the different primitive types. i.e., integer, double, logical, and character. Create matrices by attaching `dim` attributes to those vectors. Look up the help for `dimnames` and attach `dimnames` to these resulting matrices.


```r
## Generalize
add.dim <- function(vec){
    dim(vec) <- c(3, 3)
    dimnames(vec) <- list(paste("R", 1:3, sep = ""),
                          paste("C", 1:3, sep = ""))
    vec
}
## Integer
int.vec <- integer(9)
add.dim(int.vec)
```

```
##    C1 C2 C3
## R1  0  0  0
## R2  0  0  0
## R3  0  0  0
```

```r
## Double
double.vec <- numeric(9)
add.dim(double.vec)
```

```
##    C1 C2 C3
## R1  0  0  0
## R2  0  0  0
## R3  0  0  0
```

```r
## Logical
logical.vec <- logical(9)
add.dim(logical.vec)
```

```
##       C1    C2    C3
## R1 FALSE FALSE FALSE
## R2 FALSE FALSE FALSE
## R3 FALSE FALSE FALSE
```

```r
## Character
char.vec <- character(9)
add.dim(char.vec)
```

```
##    C1 C2 C3
## R1 "" "" ""
## R2 "" "" ""
## R3 "" "" ""
```

2. Create a list of length 4 and then add a `dim` attribute to it. What happens?


```r
(foo.list <- list(A = 1:2, B = 3:4, C = 5:6, D = 7:8))
```

```
## $A
## [1] 1 2
## 
## $B
## [1] 3 4
## 
## $C
## [1] 5 6
## 
## $D
## [1] 7 8
```

```r
length(foo.list)
```

```
## [1] 4
```

```r
dim(foo.list) <- c(2, 2)
foo.list
```

```
##      [,1]      [,2]     
## [1,] Integer,2 Integer,2
## [2,] Integer,2 Integer,2
```

```r
class(foo.list)
```

```
## [1] "matrix"
```

```r
class(foo.list[1,1])
```

```
## [1] "list"
```
By adding a dimension attribute, the list is coerced into a matrix of lists.

3. Look up the help page for `data.frame` and use the example code to create a small data frame containing numeric variables and factors.


```r
(foo.df <- data.frame(trt = letters[1:3], x = 1:3, y = rnorm(3)))
```

```
##   trt x         y
## 1   a 1 0.3783686
## 2   b 2 0.6103906
## 3   c 3 0.4141542
```

```r
sapply(foo.df, class)
```

```
##       trt         x         y 
##  "factor" "integer" "numeric"
```

4. Use the `seq` function to generate a subscript vector that selects those elements of a vector that have even-numbered subscripts.


```r
(foo <- round(rnorm(10), 2))
```

```
##  [1]  1.17 -0.60  0.80  0.63 -0.21  0.01 -0.03  0.74  0.08 -0.28
```

```r
(inds <- seq(2, 10, 2))
```

```
## [1]  2  4  6  8 10
```

```r
foo[inds]
```

```
## [1] -0.60  0.63  0.01  0.74 -0.28
```

5. Verify that vectors can have duplicated names and that if a subscript matches a duplicated name, only the first value is returned. What happens with `x[NA]`?


```r
foo <- 1:5
names(foo) <- c("A", "A", "A", "B", "C")
foo
```

```
## A A A B C 
## 1 2 3 4 5
```

```r
foo["A"]
```

```
## A 
## 1
```
We do see that we can have duplicate names for vectors and that, when
subsetting by name, only the first is returned.


```r
foo[NA]
```

```
## <NA> <NA> <NA> <NA> <NA> 
##   NA   NA   NA   NA   NA
```

Subsetting with `NA` returns a vector of the same length as the
vector, but all names and values are missing.


6. Use logical subscripts to extract the even-numbered elements of the `letters` vector.


```r
letters[1:26 %% 2 == 0]
```

```
##  [1] "b" "d" "f" "h" "j" "l" "n" "p" "r" "t" "v" "x" "z"
```

7. Let `x` be a vector of length 10 generated by `1:10` and suppose it has a dimension attribute so that it is a matrix with 2 columns and 5 rows. What is the matrix location of the 7th element of `x`? That is, which row and column is it in? Alternatively, which element of `x` is in the second row, first column?


```r
x <- 1:10
dim(x) <- c(5, 2)
x
```

```
##      [,1] [,2]
## [1,]    1    6
## [2,]    2    7
## [3,]    3    8
## [4,]    4    9
## [5,]    5   10
```
When `R` coerces the vector into the $5 \times 2$ matrix, it creates
it by columns, i.e. the first column will contain the
first five values and the second column the last five.

Given this, the seventh element will be the second value in the second
column with coordinates $(2, 2)$.

8. What does `as.matrix()` do when applied to a data frame with columns of different types?


```r
foo.df
```

```
##   trt x         y
## 1   a 1 0.3783686
## 2   b 2 0.6103906
## 3   c 3 0.4141542
```

```r
as.matrix(foo.df)
```

```
##      trt x   y          
## [1,] "a" "1" "0.3783686"
## [2,] "b" "2" "0.6103906"
## [3,] "c" "3" "0.4141542"
```

Because `character` is the most general class (i.e., all other classes
can be represented as a string), data.frames of mixed classes are
coerced to such that all values are strings.

9. Fix each of the following common data frame subsetting errors:

```
mtcars[mtcars$cyl = 4, ]
mtcars[-1:4, ]
mtcars[mtcars$cyl <= 5]
mtcars[mtcars$cyl == 4 | 6, ]
```
Fixed:


```r
mtcars[mtcars$cyl == 4, ]
mtcars[-c(1:4), ]
mtcars[mtcars$cyl <= 5, ]
## mtcars[mtcars$cyl == 4 | mtcars$cyl == 6, ]
mtcars[mtcars$cyl != 8, ] ## more concise
```

10. Consider the linear model: `mod <- lm(mpg ~ wt, data = mtcars)`. Describe the data structure of `mod`, including its componets. Extract the coefficients, residuals, and the residual degrees of freedom. Extract the R squared from the model summary, i.e., from `summary(mod)`.


```r
mod <- lm(mpg ~ wt, data = mtcars)
str(mod)
```

```
## List of 12
##  $ coefficients : Named num [1:2] 37.29 -5.34
##   ..- attr(*, "names")= chr [1:2] "(Intercept)" "wt"
##  $ residuals    : Named num [1:32] -2.28 -0.92 -2.09 1.3 -0.2 ...
##   ..- attr(*, "names")= chr [1:32] "Mazda RX4" "Mazda RX4 Wag" "Datsun 710" "Hornet 4 Drive" ...
##  $ effects      : Named num [1:32] -113.65 -29.116 -1.661 1.631 0.111 ...
##   ..- attr(*, "names")= chr [1:32] "(Intercept)" "wt" "" "" ...
##  $ rank         : int 2
##  $ fitted.values: Named num [1:32] 23.3 21.9 24.9 20.1 18.9 ...
##   ..- attr(*, "names")= chr [1:32] "Mazda RX4" "Mazda RX4 Wag" "Datsun 710" "Hornet 4 Drive" ...
##  $ assign       : int [1:2] 0 1
##  $ qr           :List of 5
##   ..$ qr   : num [1:32, 1:2] -5.657 0.177 0.177 0.177 0.177 ...
##   .. ..- attr(*, "dimnames")=List of 2
##   .. .. ..$ : chr [1:32] "Mazda RX4" "Mazda RX4 Wag" "Datsun 710" "Hornet 4 Drive" ...
##   .. .. ..$ : chr [1:2] "(Intercept)" "wt"
##   .. ..- attr(*, "assign")= int [1:2] 0 1
##   ..$ qraux: num [1:2] 1.18 1.05
##   ..$ pivot: int [1:2] 1 2
##   ..$ tol  : num 1e-07
##   ..$ rank : int 2
##   ..- attr(*, "class")= chr "qr"
##  $ df.residual  : int 30
##  $ xlevels      : Named list()
##  $ call         : language lm(formula = mpg ~ wt, data = mtcars)
##  $ terms        :Classes 'terms', 'formula' length 3 mpg ~ wt
##   .. ..- attr(*, "variables")= language list(mpg, wt)
##   .. ..- attr(*, "factors")= int [1:2, 1] 0 1
##   .. .. ..- attr(*, "dimnames")=List of 2
##   .. .. .. ..$ : chr [1:2] "mpg" "wt"
##   .. .. .. ..$ : chr "wt"
##   .. ..- attr(*, "term.labels")= chr "wt"
##   .. ..- attr(*, "order")= int 1
##   .. ..- attr(*, "intercept")= int 1
##   .. ..- attr(*, "response")= int 1
##   .. ..- attr(*, ".Environment")=<environment: R_GlobalEnv> 
##   .. ..- attr(*, "predvars")= language list(mpg, wt)
##   .. ..- attr(*, "dataClasses")= Named chr [1:2] "numeric" "numeric"
##   .. .. ..- attr(*, "names")= chr [1:2] "mpg" "wt"
##  $ model        :'data.frame':	32 obs. of  2 variables:
##   ..$ mpg: num [1:32] 21 21 22.8 21.4 18.7 18.1 14.3 24.4 22.8 19.2 ...
##   ..$ wt : num [1:32] 2.62 2.88 2.32 3.21 3.44 ...
##   ..- attr(*, "terms")=Classes 'terms', 'formula' length 3 mpg ~ wt
##   .. .. ..- attr(*, "variables")= language list(mpg, wt)
##   .. .. ..- attr(*, "factors")= int [1:2, 1] 0 1
##   .. .. .. ..- attr(*, "dimnames")=List of 2
##   .. .. .. .. ..$ : chr [1:2] "mpg" "wt"
##   .. .. .. .. ..$ : chr "wt"
##   .. .. ..- attr(*, "term.labels")= chr "wt"
##   .. .. ..- attr(*, "order")= int 1
##   .. .. ..- attr(*, "intercept")= int 1
##   .. .. ..- attr(*, "response")= int 1
##   .. .. ..- attr(*, ".Environment")=<environment: R_GlobalEnv> 
##   .. .. ..- attr(*, "predvars")= language list(mpg, wt)
##   .. .. ..- attr(*, "dataClasses")= Named chr [1:2] "numeric" "numeric"
##   .. .. .. ..- attr(*, "names")= chr [1:2] "mpg" "wt"
##  - attr(*, "class")= chr "lm"
```
`mod` is a list of twelve structures with class `lm`.  Each element of
`mod` contains some information about the model that was fit, such as
the model.matrix, residuals, coefficients, etc.

Because class objects in `R` are just listed with a class attribute,
the components in any class object can be extracted with the `$`
operator or by using the name in the double brackets.  Additionally,
`lm` is a generic class which supports a  common convention of
functions for extracting many of these  components with the function
name matching the component.



```r
mod$coef
```

```
## (Intercept)          wt 
##   37.285126   -5.344472
```

```r
mod[["residuals"]]
```

```
##           Mazda RX4       Mazda RX4 Wag          Datsun 710 
##          -2.2826106          -0.9197704          -2.0859521 
##      Hornet 4 Drive   Hornet Sportabout             Valiant 
##           1.2973499          -0.2001440          -0.6932545 
##          Duster 360           Merc 240D            Merc 230 
##          -3.9053627           4.1637381           2.3499593 
##            Merc 280           Merc 280C          Merc 450SE 
##           0.2998560          -1.1001440           0.8668731 
##          Merc 450SL         Merc 450SLC  Cadillac Fleetwood 
##          -0.0502472          -1.8830236           1.1733496 
## Lincoln Continental   Chrysler Imperial            Fiat 128 
##           2.1032876           5.9810744           6.8727113 
##         Honda Civic      Toyota Corolla       Toyota Corona 
##           1.7461954           6.4219792          -2.6110037 
##    Dodge Challenger         AMC Javelin          Camaro Z28 
##          -2.9725862          -3.7268663          -3.4623553 
##    Pontiac Firebird           Fiat X1-9       Porsche 914-2 
##           2.4643670           0.3564263           0.1520430 
##        Lotus Europa      Ford Pantera L        Ferrari Dino 
##           1.2010593          -4.5431513          -2.7809399 
##       Maserati Bora          Volvo 142E 
##          -3.2053627          -1.0274952
```

```r
df.residual(mod)
```

```
## [1] 30
```

```r
summary(mod)$r.sq
```

```
## [1] 0.7528328
```

